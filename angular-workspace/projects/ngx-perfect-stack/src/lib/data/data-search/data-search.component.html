<div class="container-fluid mt-3" *ngIf="ctx$ | async as ctx">

  <ng-container>
    <div class="container-fluid mt-3 bg-light py-3 shadow-sm border">
      <h2 class="mb-3">{{ctx.metaPage.title}}</h2>
      <lib-controller [ctx]="ctx" [template]="ctx.metaPage.templates[0]">
        <ng-container BottomLeftActions>
          <button type="submit" class="btn btn-outline-success me-2" (click)="onNew(ctx)">New...</button>
        </ng-container>
        <ng-container BottomRightActions>
          <button class="btn btn-outline-secondary me-2" (click)="onReset()">Reset</button>
          <button type="submit" class="btn btn-primary me-2" (click)="onSearch(ctx)">Search</button>
        </ng-container>
      </lib-controller>
    </div>
  </ng-container>

  <ng-container *ngIf="resultTableCells">
    <table class="table table-striped table-hover">
      <thead>
      <tr>
        <th scope="col" *ngFor="let nextCell of resultTableCells[0]">
          <ng-container *ngIf="nextCell.attribute">
            {{nextCell.attribute.label}}
          </ng-container>
        </th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let item of searchResults" (click)="onSelectRow(item.id)">
        <td *ngFor="let nextCell of resultTableCells[0]">
          <ng-container *ngIf="nextCell.attribute">
            {{displayValue(nextCell.attribute, item)}}
          </ng-container>
        </td>
      </tr>
      </tbody>
    </table>

    <ngb-pagination [collectionSize]="collectionSize" [maxSize]="5" [(page)]="pageNumber" [pageSize]="pageSize" (pageChange)="onSearch(ctx)"></ngb-pagination>
  </ng-container>

</div>
