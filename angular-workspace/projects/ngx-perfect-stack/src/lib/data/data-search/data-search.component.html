<div class="container-fluid container-page" *ngIf="ctx$ | async as ctx">

  <ng-container *ngIf="searchCriteriaTemplate">
    <div class="d-flex justify-content-between">
      <div>
        <h3>{{ctx.metaPage.title}}</h3>
      </div>
      <div>
        <button type="button" class="btn btn-success" (click)="onNew(ctx)" id="newBtn">{{newButtonLbl}}</button>
      </div>
    </div>

    <form class="container-fluid container-form">
      <lib-controller [ctx]="ctx" [template]="searchCriteriaTemplate">
        <ng-container BottomLeftActions>
        </ng-container>
        <ng-container BottomRightActions>
          <button type="button" class="btn btn-outline-primary me-2" (click)="onReset(ctx)" id="resetBtn">Reset</button>
          <button type="submit" class="btn btn-primary" (click)="onSearch(ctx)" id="searchBtn">Search</button>
        </ng-container>
      </lib-controller>
    </form>
  </ng-container>

  <div class="container-table" *ngIf="resultTableCells">

    <div class="collection-size-found">
      {{collectionSize}} {{this.resultTableMetaEntity.pluralName}} found
    </div>

    <!--<table class="table table-hover">
      <thead>
      <tr>
        <th scope="col" *ngFor="let nextCell of resultTableCells[0]">
          <ng-container *ngIf="nextCell.attribute">
            {{nextCell.attribute.label}}
          </ng-container>
        </th>
      </tr>
      </thead>
      <tbody>
      &lt;!&ndash;<tr *ngFor="let row of searchResults.controls; index as i" (click)="onSelectRow(row['id'].value)">
        <td *ngFor="let nextCell of resultTableCells[0]">
          &lt;!&ndash;<ng-container *ngIf="nextCell.attribute">
            {{displayValue(nextCell.attribute, item)}}
          </ng-container>&ndash;&gt;

          &lt;!&ndash; Have changed search results to use our Cell class for rendering &ndash;&gt;
          <lib-cell [mode]="'view'" [cell]="nextCell" [formGroup]="getFormGroupForRow(i)"></lib-cell>
        </td>
      </tr>&ndash;&gt;

      <ng-container [formArrayName]="'results'" *ngFor="let group of searchResults.controls; let i=index">
        <tr [formGroupName]="i" (click)="onRowClicked(i)">
          <td *ngFor="let nextCell of resultTableCells[0]">
            <ng-container *ngIf="nextCell.attribute">
              <lib-cell [mode]="mode" [cell]="nextCell" [formGroup]="getFormGroupForRow(i)"></lib-cell>
            </ng-container>
          </td>
        </tr>
      </ng-container>

      </tbody>
    </table>-->

    <lib-table-layout
      [ctx]="ctx"
      [template]="resultTableTemplate"
      [mode]="'view'"
      [formGroup]="searchResultsFormGroup"
      [relationshipProperty]="'results'">
    </lib-table-layout>


    <ngb-pagination class="d-flex justify-content-center" [collectionSize]="collectionSize" [maxSize]="5" [(page)]="pageNumber" [pageSize]="pageSize" (pageChange)="onSearch(ctx)">
      <ng-template ngbPaginationFirst>First</ng-template>
      <ng-template ngbPaginationLast>Last</ng-template>
      <ng-template ngbPaginationPrevious>Previous</ng-template>
      <ng-template ngbPaginationNext>Next</ng-template>
      <ng-template ngbPaginationEllipsis>...</ng-template>
      <ng-template ngbPaginationNumber let-page>{{ page }}</ng-template>
    </ngb-pagination>
  </div>

  <!-- whitespace padding at bottom of page -->
  <div class="my-5 py-5"></div>

</div>

