<ng-container *ngIf="cells$ | async as cells">

  <table class="table" [ngClass]="getStyleClasses()" [formGroup]="formGroup">
    <thead>
    <tr *ngIf="cells">
      <th *ngFor="let nextCell of cells[0]">
        <ng-container *ngIf="nextCell.attribute">
          {{nextCell.attribute.label}}
        </ng-container>
        <ng-container *ngIf="nextCell.tool">
          {{nextCell.tool.label}}
        </ng-container>
      </th>
    </tr>
    </thead>
    <tbody>

    <ng-container *ngIf="cells && attributes && attributes.length > 0">
      <ng-container [formArrayName]="relationshipProperty" *ngFor="let group of attributes.controls; let i=index">
        <tr [formGroupName]="i" (click)="onRowClicked(i)">
          <td *ngFor="let nextCell of cells[0]">
            <ng-container *ngIf="nextCell.attribute || nextCell.tool">
              <lib-cell [mode]="mode" [cell]="nextCell" [formGroup]="getFormGroupForRow(i)"></lib-cell>
            </ng-container>
          </td>
          <td *ngIf="mode === 'edit'">
            <span class="btn-icon text-danger material-icons" (click)="onDeleteRow(i)">delete</span>
          </td>
        </tr>
      </ng-container>
    </ng-container>

    <ng-container *ngIf="cells && attributes && attributes.length == 0">
      <tr>
        <td class="small" colspan="99">No items</td>
      </tr>
    </ng-container>

    </tbody>
  </table>

  <div class="d-flex" *ngIf="mode === 'edit'">
    <a class="text-primary" (click)="onAddRow()" id="addRowBtn" role="button">
      <span class="material-icons align-middle">add_circle</span>
      Add another
    </a>
  </div>
</ng-container>


