<ng-container *ngIf="ctx">

  <!-- NEW: the FormMap way of doing things -->
  <ng-container *ngIf="ctx.formMap">
    <!-- These two ng-containers here are a workaround for a problem where the readonly attribute is not updating
     when the user flips between view and edit mode. I think it's something to do with changing a value in the code
     is not triggering an update in the framework. Need to understand this behaviour better so that this bit of
     uglyness can be removed -->
    <ng-container *ngIf="ctx.mode === 'view'">
      <lib-layout [ctx]="ctx" [template]="template" [showTemplateHeadings]="showTemplateHeadings"></lib-layout>
    </ng-container>

    <ng-container *ngIf="ctx.mode !== 'view'">
      <lib-layout [ctx]="ctx" [template]="template" [showTemplateHeadings]="showTemplateHeadings"></lib-layout>
    </ng-container>
  </ng-container>

  <div class="d-flex my-2">
    <ng-content select="[BottomLeftActions]"></ng-content>
    <div class="flex-grow-1"></div>
    <ng-content select="[BottomRightActions]"></ng-content>
  </div>

</ng-container>
