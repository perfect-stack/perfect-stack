<ng-container *ngIf="ctx">

  <form class="form" #form="ngForm" [formGroup]="ctx.entityForm"> <!-- (ngSubmit)="onSubmit()" -->

    <!-- These two ng-containers here are a workaround for a problem where the readonly attribute is not updating
     when the user flips between view and edit mode. I think it's something to do with changing a value in the code
     is not triggering an update in the framework. Need to understand this behaviour better so that this bit of
     uglyness can be removed -->
    <ng-container *ngIf="ctx.mode === 'view'">
      <lib-layout [mode]="ctx.mode" [template]="template" [formGroup]="ctx.entityForm"></lib-layout>
    </ng-container>

    <ng-container *ngIf="ctx.mode !== 'view'">
      <lib-layout [mode]="ctx.mode" [template]="template" [formGroup]="ctx.entityForm"></lib-layout>
    </ng-container>

    <div class="d-flex">
      <ng-content select="[BottomLeftActions]"></ng-content>
      <div class="flex-grow-1"></div>
      <ng-content select="[BottomRightActions]"></ng-content>
      <ng-content></ng-content>
    </div>

  </form>

</ng-container>
