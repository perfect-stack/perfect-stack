<div class="wrapper">
  <div class="p-2 cell-highlight hover-highlight" draggable droppable (onDrop)="onItemDrop($event)">
    <div class="row">
      <div class="col-12" [ngStyle]="{'min-height': getCSSHeight(cell)}">
        <ng-container *ngIf="attribute">
          <label [for]="attribute.name">
            <span placement="right" [ngbTooltip]="attribute.description">{{attribute.label}}</span>
          </label>

          <div [ngSwitch]="attribute.type">
            <ng-container *ngSwitchCase="'Date'">
              <app-date-picker-control [formGroup]="entityForm" [name]="attribute.name"></app-date-picker-control>
            </ng-container>

            <ng-container *ngSwitchCase="['Text', 'Html', 'Integer'].includes(attribute.type) ? attribute.type : ''">
              <ng-container [ngSwitch]="cell.component">
                <ng-container *ngSwitchCase="'TextArea'">
                  <app-text-area-control [cell]="cell" [formGroup]="entityForm" [attribute]="attribute"></app-text-area-control>
                </ng-container>

                <ng-container *ngSwitchDefault>
                  <lib-text-field-control [formGroup]="entityForm" [name]="attribute.name"></lib-text-field-control>
                </ng-container>
              </ng-container>
            </ng-container>

            <ng-container *ngSwitchCase="'Enumeration'">
              <select class="form-select"></select>
            </ng-container>

            <ng-container *ngSwitchCase="'OneToMany'">
              <ng-container *ngIf="cell.template">
                <lib-template-controller [template]="cell.template"></lib-template-controller>
              </ng-container>
            </ng-container>

            <ng-container *ngSwitchCase="'OneToOne'">
              <ng-container *ngIf="cell.template">
                <lib-template-controller [template]="cell.template"></lib-template-controller>
              </ng-container>
            </ng-container>

            <ng-container *ngSwitchCase="'ManyToOne'">
              <ng-container [ngSwitch]="cell.component">
                <ng-container *ngSwitchCase="'Select'">
                  <select class="form-select"></select>
                </ng-container>

                <ng-container *ngSwitchCase="'SelectTwo'">
                  <div class="d-flex">
                    <select class="form-select"></select>
                    <select class="form-select"></select>
                  </div>
                </ng-container>

                <ng-container *ngSwitchDefault>
                  <app-many-to-one-control [formGroup]="entityForm" [mode]="'edit'" [attribute]="attribute"></app-many-to-one-control>
                </ng-container>
              </ng-container>
            </ng-container>

            <ng-container *ngSwitchCase="'OneToPoly'">
              <p>CardLayout for OneToPoly goes here...</p>
            </ng-container>

            <ng-container *ngSwitchDefault>
              ERROR: Missing or unknown attribute type of: "{{attribute.type}}"
            </ng-container>
          </div>
        </ng-container>

        <ng-container *ngIf="!attribute && cell.template">
          <lib-template-controller [template]="cell.template"></lib-template-controller>
        </ng-container>
      </div>
    </div>
  </div>

  <ng-container *ngIf="mouseActive">
    <div class="overlay-top-right p-1">
      <span class="material-icons hover-highlight no_selection" (click)="onChangeWidth(-1, $event)">remove_circle_outline</span>
      <span class="material-icons hover-highlight no_selection" (click)="onChangeWidth(1, $event)">add_circle_outline</span>
    </div>
  </ng-container>

  <ng-container *ngIf="mouseActive">
    <div class="overlay-bottom-left p-1">
      <span class="material-icons hover-highlight no_selection" (click)="onSettings()">settings</span>
      <span class="material-icons hover-highlight no_selection" (click)="onDeleteCell()">highlight_off</span>
      <span class="material-icons hover-highlight no_selection" (click)="onClearCell()">block</span>
      <span class="material-icons hover-highlight no_selection" (click)="onAddTemplate()">view_quilt</span>
    </div>
  </ng-container>

  <ng-container *ngIf="mouseActive">
    <div class="d-flex flex-column overlay-bottom-right p-1">
      <span class="material-icons hover-highlight no_selection" (click)="onChangeHeight(-1)">remove_circle_outline</span>
      <span class="material-icons hover-highlight no_selection" (click)="onChangeHeight(1)">add_circle_outline</span>
    </div>
  </ng-container>

</div>

